@using AgrifoodManagement.Web.Models.Shop

@{
    Layout = "~/Views/Shared/_ConsumerNavbarLayout.cshtml";
    ViewData["Title"] = "Your Basket";
}

@model BasketViewModel

<div class="basket-container">
    <h2 class="basket-title">Your Shopping Basket</h2>

    @if (!Model.Items.Any())
    {
        <div class="text-center py-5">
            <i class="fas fa-shopping-basket fa-4x text-muted mb-3"></i>
            <h4 class="text-muted">Your basket is empty</h4>
            <a href="@Url.Action("Shop", "Consumer")" class="btn btn-primary mt-3">
                Start Shopping
            </a>
        </div>
    }
    else
    {
        <div class="row">
            <div class="col-lg-8">
                <div class="card shadow-sm mb-4">
                    <div class="card-body p-0">
                        <ejs-grid id="BasketGrid" dataSource="@Model.Items"
                                  allowPaging="true"
                                  allowSorting="true"
                                  height="auto">
                            <e-grid-editSettings allowEditing="true"
                                                 allowDeleting="true"
                                                 mode="Normal" />

                            <e-grid-columns>
                                <e-grid-column field="Id"
                                               isPrimaryKey="true"
                                               visible="false"></e-grid-column>

                                <e-grid-column field="ImageUrl"
                                               headerText="Image"
                                               width="120"
                                               textAlign="Center"
                                               template='<img src="${ImageUrl}" alt="${Name}" style="width:60px;height:60px;object-fit:cover;" class="rounded" />'>
                                </e-grid-column>

                                <e-grid-column field="Name"
                                               headerText="Product"
                                               width="200"
                                               textAlign="Center" />

                                <e-grid-column field="Category"
                                               headerText="Category"
                                               width="120"
                                               textAlign="Center">
                                </e-grid-column>

                                <e-grid-column field="QuantityOrdered"
                                               headerText="Qty"
                                               width="100"
                                               textAlign="Center"
                                               allowEditing="true"
                                               editType="numericedit">
                                </e-grid-column>

                                <e-grid-column field="Price"
                                               headerText="Price Details (lei)"
                                               width="200"
                                               textAlign="Right">
                                </e-grid-column>
                            </e-grid-columns>
                        </ejs-grid>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="order-summary">
                    <div class="summary-row">
                        <span class="summary-label">Subtotal:</span>
                        <span class="summary-value">@Model.SubTotal.ToString("C2")</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">Shipping:</span>
                        <span class="summary-value">@Model.ShippingCost.ToString("C2")</span>
                    </div>
                    <div class="summary-row total-row">
                        <span class="summary-label fw-bold">Total:</span>
                        <span class="summary-value fw-bold">@Model.Total.ToString("C2")</span>
                    </div>
                    <div class="order-summary-actions d-flex justify-content-between mt-4">
                        <ejs-button id="continueShoppingBtn" cssClass="e-outline" content="CONTINUE SHOPPING"
                                    onclick="window.location='@Url.Action("Shop","Consumer")'"></ejs-button>
                        <ejs-button id="checkoutBtn" cssClass="e-primary" content="CHECKOUT"
                                    onclick="window.location='@Url.Action("Checkout","Order")'"></ejs-button>
                    </div>
                </div>
            </div>
        </div>
    }
</div>