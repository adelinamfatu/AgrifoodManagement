@{
    Layout = "_AdminLayout";
    var sidebarItems = ViewBag.SidebarItems as List<SidebarItem>;
}

<div class="layout-container">
    <div class="toolbar-container">
        <ejs-toolbar id="toolbar">
            <e-toolbar-items>
                <e-toolbar-item prefixIcon="bi bi-list" cssClass="menu-button" id="menu-toggle"></e-toolbar-item>
                <e-toolbar-item text="Agri-Food Management" cssClass="app-title"></e-toolbar-item>
            </e-toolbar-items>
        </ejs-toolbar>
    </div>

    <div class="content-wrapper">
        <div id="sidebar-wrapper">
            <ejs-sidebar id="sidebarObj" Width="260px" Position="Left" target="#contentArea" type="Push">
                <e-content-template>
                    <div id="sidebar-menu">
                        @if (sidebarItems != null)
                        {
                            @foreach (var item in sidebarItems)
                            {
                                <div class="menu-item @(item.Id == ViewBag.ActiveItemId ? "active" : "")" onclick="navigateTo('@item.Url', '@item.Id')">
                                    <i class="menu-item-icon @item.IconCss"></i>
                                    <span class="menu-item-text">@item.Name</span>
                                </div>
                            }
                        }
                    </div>
                </e-content-template>
            </ejs-sidebar>
        </div>

        <div id="contentArea">
            @RenderBody()
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize the sidebar
        var sidebar = document.getElementById('sidebarObj').ej2_instances[0];

        // Toggle sidebar on menu button click
        document.getElementById('menu-toggle').addEventListener('click', function () {
            sidebar.toggle();
        });
    });

    function navigateTo(url, id) {
        // Remove active class from all menu items
        document.querySelectorAll('.menu-item').forEach(item => {
            item.classList.remove('active');
        });

        // Add active class to clicked item
        document.querySelector(`.menu-item[onclick*='${id}']`).classList.add('active');

        // Navigate to the new page
        window.location.href = url;
    }
</script>